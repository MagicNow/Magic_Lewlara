function updateImage(){$.ajax({type:"POST",url:baseUrl+"/meu-perfil/api/get/image"}).done(function(e){$(".img-perfil").attr("src",e)})}function updateNames(){$.ajax({type:"POST",url:baseUrl+"/meu-perfil/api/get/names"}).done(function(e){$("#label-names").html(e.firstname+" "+e.lastname)})}function updateUsername(){$.ajax({type:"POST",url:baseUrl+"/meu-perfil/api/get/username"}).done(function(e){$("#label-username").html(e)})}function updatePersonalLinks(){var e=0,a=0;$.ajax({type:"POST",url:baseUrl+"/meu-perfil/api/get/personal-links"}).done(function(l){for(e=l.length,$("#label-personal-links").html(""),a;a<e;a++)$("#label-personal-links").append(l[a]+"<br/>")})}function updateEmail(){$.ajax({type:"POST",url:baseUrl+"/meu-perfil/api/get/email"}).done(function(e){$("#label-email").html(e)})}!function(e){e.fn.serializeObject=function(){var a=this,l={},n={},t={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(e,a,l){return e[a]=l,e},this.push_counter=function(e){return void 0===n[e]&&(n[e]=0),n[e]++},e.each(e(this).serializeArray(),function(){if(t.validate.test(this.name)){for(var n,i=this.name.match(t.key),s=this.value,r=this.name;void 0!==(n=i.pop());)r=r.replace(new RegExp("\\["+n+"\\]$"),""),n.match(t.push)?s=a.build([],a.push_counter(r),s):n.match(t.fixed)?s=a.build([],n,s):n.match(t.named)&&(s=a.build({},n,s));l=e.extend(!0,l,s)}}),l}}(jQuery),$(document).on("ready",function(){$(".toggle-edit-block").on("click",function(e){$(this).parent().parent().find(".edit-block").slideToggle(),$(this).parent().parent().find(".edit-bt, .info-placeholder").slideToggle()}),$(".cancel-edit-block").on("click",function(e){$(this).parent().parent().parent().parent().find(".edit-block").slideToggle(),$(this).parent().parent().parent().parent().find(".edit-bt, .info-placeholder").slideToggle()}),$("#cancel-links").on("click",function(){$(".group-link-pessoal:not(.edit-block)").remove()}),$(document).on("change",".perfil .btn-file :file",function(){var e=$(this),a=e.get(0).files?e.get(0).files.length:1,l=e.val().replace(/\\/g,"/").replace(/.*\//,"");e.trigger("fileselect",[a,l])}),$("#perfil_imagem_upload_bt :file").on("fileselect",function(e,a,l){$("#usuario_novo_imagem_selecionada").html(l);var n=0,t=0,i=new FormData($("#ajaxProfile")[0]);$.ajax({type:"POST",url:baseUrl+"/meu-perfil/api/update/save-image",contentType:!1,processData:!1,data:i}).done(function(e){if($("#ajax-msgs").html(""),200==e.code){for($("#ajax-msg").removeClass("alert-danger").addClass("alert alert-success"),n=e.msgs.length,t;t<n;t++)$("#ajax-msgs").append("<li>"+e.msgs[t]+"</li>");updateImage()}else{if($("#ajax-msg").removeClass("alert-success").addClass("alert alert-danger"),!e.msgs)return $("#ajax-msgs").append("<li>Erro interno no Servidor</li>"),0;for(n=e.msgs.length,t;t<n;t++)$("#ajax-msgs").append("<li>"+e.msgs[t]+"</li>")}})}),$("#perfil_adicionar_link_pessoal").on("click",function(e){e.preventDefault(),link_pessoal_count++;var a='<div class="col-sm-12"><div class="col-sm-5 pt7"><input class="form-control" name="link_pessoal['+link_pessoal_count+']" type="text"></div></div>',l=$(".group-link-pessoal > div");l.eq(l.length-2).after(a)}),$(".save-edit-block").on("click",function(e){var a=$(this).parent().parent().parent().parent(),l=0,n=0,t=JSON.stringify($("#ajaxProfile").serializeObject()),i=$(this).attr("id");$.ajax({type:"POST",url:baseUrl+"/meu-perfil/api/update/"+i,data:t}).done(function(e){if($("#ajax-msgs").html(""),200==e.code){for($("#ajax-msg").removeClass("alert-danger").addClass("alert alert-success"),l=e.msgs.length,n;n<l;n++)$("#ajax-msgs").append("<li>"+e.msgs[n]+"</li>");switch(a.find(".edit-block").slideToggle(),a.find(".edit-bt, .info-placeholder").slideToggle(),i){case"save-username":updateUsername();break;case"save-email":updateEmail();break;case"save-personal-links":updatePersonalLinks();break;case"save-names":updateNames();break;default:alert(i)}}else{if($("#ajax-msg").removeClass("alert-success").addClass("alert alert-danger"),!e.msgs)return $("#ajax-msgs").append("<li>Erro interno no Servidor</li>"),0;for(l=e.msgs.length,n;n<l;n++)$("#ajax-msgs").append("<li>"+e.msgs[n]+"</li>")}})})});